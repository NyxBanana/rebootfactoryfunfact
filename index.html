<!DOCTYPE html>
<html lang="fr">
<head>
	<title>FunFact</title>
	<meta charset="UTF-8" />
	<meta name="viewport" content="initial-scale=1.0" />
	<link rel="stylesheet" href="_styles/styles.css" />
	<link href='http://fonts.googleapis.com/css?family=Roboto:400,100,700' rel='stylesheet' type='text/css'>
</head>
<body>
	<header>
		<h1 class="head"><a href="#home"><span class="fun">Fun</span>fact</a></h1>

		<button class="btn--openfilter">Filtres</button>
		<button class="btn--openprofile">Profile</button>
	</header>

	<main>

		<section class="section__filter">
				<ul class="filters">
					<li><button class="filters__sport">Sport</button></li>
					<li><button class="filters__art">Art</button></li>
					<li><button class="filters__culture">Culture</button></li>
					<li><button class="filters__cinema">Tv/Cinéma</button></li>
					<li><button class="filters__sciences">Sciences</button></li>
					<li><button class="filters__history">Histoire</button></li>
					<li><button class="filters__world">Monde</button></li>
					<li><button class="filters__celebrities">Célébrités</button></li>
					<li><button class="filters__fails">Fails</button></li>
				</ul>
		</section>

		<section id="home" class="section section__home">
			<article class="article article__fact">
				<p class="fact"></p>
			
				<div class="infofact clearfix">
					<!-- ajouter étoile fav -->

					<ul>
						<li class="author"></li>
						<li class="source"></li>
					</ul>
				</div>
			</article>

			<button class="addfact">+</button>
		</section>

		<section id="addFact" class="section section__addFact">
			<form action="" method="post" class="form--addafact">
	       		<fieldset>
	       			<input class="fact--add" name="fact--src" type="text" value="" placeholder="Pseudo">

		            <select class="categorie" name="categorie" size="1">
		                <option value="" disabled selected>Catégorie</option>
		                <option value="sport">Sport</option>
		                <option value="cinema">Cinéma</option>
		                <option value="culture">Culture</option>
		                <option value="art">Art</option>                    
		                <option value="monde">Monde</option>
		                <option value="celebrite">Célébrité</option>
		                <option value="autre">Autre</option>
		            </select>
		            
		            <div class="triangle"></div>
		            
		            <textarea class="insertfact" name="fact" rows="1" cols="1" placeholder="Insérer votre fact"></textarea>
		            
		            <input class="fact--add" name="fact--src" type="text" value="" placeholder="Source (facultatif)">
		            
		            <input class="addfact" tabindex="1" type="submit" value="v"/>
	       		</fieldset>
			</form>
		</section>

		<section id="profil" class="section section__profil">
			<ul>
				<li><button class="btn--myfact">Mes facts</button></li>
				<li><button class="btn--fav">Mes favoris</button></li>
			</ul>

			<div class="inProfileClose section__fav">
				<article class="article article__fact article__mesFav">
					<p class="factfav">Techniquement, ce n’est pas la Seine mais l’Yonne qui coule à Paris.</p>
					<ul>
						<li>source</li>
						<li>author</li>
					</ul>

					<div class="options">
						<button class="btn--share">Share</button>
					</div>
				</article>

				<article class="article article__fact article__mesFav">
					<p class="factfav">Techniquement, THIS IS A FAV, REMEMBER, THIS. IS. A. FAV.</p>
					<ul>
						<li>source</li>
						<li>author</li>
					</ul>

					<div class="options">
						<button class="btn--share">Share</button>
					</div>
				</article>

				<article class="article article__fact article__mesFav">
					<p class="factfav">Techniquement, blah blah 3</p>
					<ul>
						<li>source</li>
						<li>author</li>
					</ul>

					<div class="options">
						<button class="btn--share">Share</button>
					</div>
				</article>
			</div>

			<div class="inProfileOpen section__mesFacts">
				<article class="article article__fact artcile__mesFacts">
					<p class="factperso">En Alabama, il est interdit de jouer aux dominos le dimanche.</p>
					<ul>
						<li>source</li>
					</ul>

					<div class="options">
						<button class="btn--share">Share</button>
					</div>
				</article>

				<article class="article article__fact artcile__mesFacts">
					<p class="factperso">En Alaba - NEVERMIND, THIS IS A FACT ! -</p>
					<ul>
						<li>source</li>
					</ul>

					<div class="options">
						<button class="btn--share">Share</button>
					</div>
				</article>

				<article class="article article__fact artcile__mesFacts">
					<p class="factperso">En Alabama, blah blah blah 3.</p>
					<ul>
						<li>source</li>
					</ul>

					<div class="options">
						<button class="btn--share">Share</button>
					</div>
				</article>
			</div>
		</section>

	</main>
	<footer>
	</footer>

	<script src="_js/jquery-1.11.2.min.js"></script>
	<script src="_js/Hammer.JS-v2.0.4.js"></script>
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			"use strict";

			if (location.hash === "") location.hash = "home";

		// Filters
			var openFilter = document.getElementsByClassName("btn--openfilter")[0],
				filter = document.getElementsByClassName("section__filter")[0],
				catfilt = document.getElementsByClassName("filters")[0];

			openFilter.addEventListener("click", function() {
				filter.classList.toggle("filter--open");
				filter.classList.add("filter--transition");
				catfilt.classList.toggle("filterList--open");
			});

			filter.addEventListener("transitionend", function() {
				filter.classList.remove("filter--transition");
			});

		// Facts
			/*	(function() {
				"use strict";
				var facts = document.querySelectorAll(".article__fact .fact");
				for (var i = 0; i < facts.length; i++) {
					facts[i].addEventListener("click", function() {
						var option = this.nextElementSibling.nextElementSibling;
						if (option !== void(0))
							option.classList.add("active");
					});
				}
				var options = document.querySelectorAll(".article__fact .options");
				for (i = 0; i < options.length; i++) {
					options[i].addEventListener("click", function() {
						this.classList.remove("active");
					});
				}
			})();*/

		// Forms
			"use strict";
			var floatlabels = document.getElementsByClassName("floatlabel");

			for (var i = 0; i < floatlabels.length; i++) {
				var input = floatlabels[i].getElementsByTagName("input")[0];
				var label = floatlabels[i].getElementsByTagName("label")[0];

				input.placeholder = label.innerText;

				input.addEventListener("input", function() {
					var label = this.previousElementSibling;

					if (this.value.length != 0)
						label.classList.add("visible");
					else
						label.classList.remove("visible");
				});
			}

		//Mesfacts/MesFav
			var btnMesFact = document.getElementsByClassName("btn--myfact")[0],
				btnMesFav = document.getElementsByClassName("btn--fav")[0],
				mesFacts = document.getElementsByClassName("artcile__mesFacts"),
				mesFavs = document.getElementsByClassName("article__mesFav"),
				sectionFact = document.getElementsByClassName("section__mesFacts")[0],
				sectionFav = document.getElementsByClassName("section__fav")[0];

			// ========================================
			// DELAYS
			// ========================================
			for (i = 0; i < mesFacts.length; i++) {
				addAnimationDelay(mesFacts[i], 0.1 * i);
			}

			for (i = 0; i < mesFavs.length; i++) {
				addAnimationDelay(mesFavs[i], 0.1 * i);
			}

			// ========================================
			// BUTTON FAV (closes facts, opens fav)
			// ========================================
			function isClosed(section) {
				return section.classList.contains("inProfileClose");
			}

			btnMesFav.addEventListener("click", function() {
				if (!isClosed(sectionFav)) {
					return;
				}

				for (var i = 0; i < mesFacts.length; i++) {
					mesFacts[i].classList.add("mesFact--close");
				}
			});

			// the last fact to close inits the favs opening
			mesFacts[mesFacts.length - 1].addEventListener("webkitAnimationEnd", function() {
				if(this.classList.contains("mesFact--open")) {
					// remove the animation classes
					// do NOT close facts if the animation is the opening one.


					return;
				} else {
					for (i = 0; i < mesFacts.length; i++) {
						mesFacts[i].classList.remove("mesFact--close");
					}
				}

				// animation d'ouverture
				for (i = 0; i < mesFavs.length; i++) {
					mesFavs[i].classList.add("mesFav--open");
				}

				// cacher la section facts
				sectionFact.classList.add("inProfileClose");

				// afficher la section fav
				sectionFav.classList.remove("inProfileClose");
			});

			// ========================================
			// BUTTON FACT (closes favs, opens facts)
			// ========================================
			btnMesFact.addEventListener("click", function() {
				if (!isClosed(sectionFact)) {
					return;
				}

				// ferme les favs
				for (var i = 0; i < mesFavs.length; i++) {
					mesFavs[i].classList.add("mesFav--close");
				}
			});

			mesFavs[mesFavs.length - 1].addEventListener("webkitAnimationEnd", function() {
				if(this.classList.contains("mesFav--open")) {
					// remove the animation classes
					// do NOT close fav if the animation is the opening one.

					for (i = 0; i < mesFavs.length; i++) {
						mesFavs[i].classList.remove("mesFav--open");
					}

					return;
				} else {
					for (i = 0; i < mesFavs.length; i++) {
						mesFavs[i].classList.remove("mesFav--close");
					}
				}

				// animation de l'ouverture des facts
				for (var i = 0; i < mesFacts.length; i++) {
					mesFacts[i].classList.add("mesFact--open");
				}

				// cachetage des favs
				sectionFav.classList.add("inProfileClose");

				// affichage des facts
				sectionFact.classList.remove("inProfileClose");
			});

			// =====================================
			// ANIMATION CLEANUP
			// =====================================

			for (i = 0; i < mesFacts.length; i++) {
				mesFacts[i].addEventListener("webkitAnimationEnd", function() {
					this.classList.remove("mesFact--open");
				});
			}

			for (i = 0; i < mesFavs.length; i++) {
				mesFavs[i].addEventListener("webkitAnimationEnd", function() {
					this.classList.remove("mesFav--open");
				});
			}
		});

		var facts = [
			{
				category : "sport",
				text : "A Detroit, un homme de 41 ans est mort noyé dans 50cm d’eau après avoir passé la tête dans une bouche d’égout et s’être bloqué… en cherchant ses clés de voiture.",
				source : "Darwin Award",
				author : "NyxBanana"
			},
			{
				category : "fails",
				text : "A Paris, une poubelle est considérée comme une arme mortelle.",
				source : "htt://",
				author : "XynPapple"
			},
			{
				category : "history",
				text : "Le terme OK  vient de la Guerre de Sécession : ils compilaient le nombre de morts dans un registre en indiquant le nombre de tués à coté d'un K pour 'Killed'. Les bons jours on avait aucun mort, soit 0 K, devenu par la suite OK.",
				source : "htt://",
				author : "XynPapple"
			},
			{
				category : "world",
				text : "En Alabama, il est illégal de porter une fausse moustache qui puisse causer des rires à l’église.",
				source : "htt://",
				author : "NyxBanana"
			},
			{
				category : "world",
				text : "Un milliard de Chinois se partagent 100 noms de famille.",
				source : "htt://",
				author : "NyxBanana"
			},
			{
				category : "culture",
				text : "Jésus est né vers l’an 7 ou 5 avant Jésus-Christ.",
				source : "htt://",
				author : "NyxBanana"
			},
			{
				category : "culture",
				text : "L’inventeur du Coca-Cola s’est inspiré d’un vin français à la coca.",
				source : "htt://",
				author : "NyxBanana"
			},
			{
				category : "fails",
				text : "En France, il est interdit d’appeler un cochon Napoléon.",
				source : "htt://",
				author : "XynPapple"
			},
			{
				category : "world",
				text : "Au Royaume-uni, un homme peut uriner en public mais uniquement sur la roue arrière d’un véhicule motorisé sur lequel il aura préalablement posé sa main droite.",
				source : "htt://",
				author : "NyxBanana"
			}
		];

		/*var randomFact = Math.floor(Math.random() * facts.length);*/
		var currentFact = 0;

		$(".article__fact .fact").html(facts[currentFact].text);
		$(".article__fact .source").html(facts[currentFact].source);
		$(".article__fact .author").html(facts[currentFact].author);

		function addAnimationDelay(node, delay) {
			node.style.animationDelay = delay + 's';
			node.style.webkitAnimationDelay = delay + 's';
		}
	</script>
</body>
</html>